---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
In this part the report shows the steps followed to load the activity monitoring data.
```{r,echo=TRUE}
unzip("activity.zip")
csvdat <- read.csv("activity.csv"
                   ,colClasses=c("numeric","Date","numeric"))
str(csvdat)
```
## What is mean total number of steps taken per day?
In this part we calculate the mean of the total number of steps taken per day.   
* We first create a data model in which the total number of steps per day is calculated from the original data set.   
* We then use this data to plot a histogram of the total number of steps per day.  
* We then use the same data to calculate the mean and the median.

```{r,echo=TRUE}
stepsDay <- data.frame(steps = tapply(csvdat$steps, csvdat$date,sum))
hist(stepsDay$steps
     , main ="histogram of total number of steps per day"
     ,col='red'
     ,breaks = 20
     ,xlab = "Number of steps per day")
mu <- mean(stepsDay$steps, na.rm=T)
mdn <- median(stepsDay$steps, na.rm=T)
```


The calculated mean is `r mu` and the median is `r mdn`



## What is the average daily activity pattern?

In this part of the report we create a time series that displays the average steps taken in a 5 min interval across all days. The created data frame is then plotted.

```{r}
minintervalAV <- data.frame(Steps=tapply(csvdat$steps,csvdat$interval,mean,na.rm=T)
                            ,Interval=unique(csvdat$interval))
summary(minintervalAV)
plot(
     minintervalAV$Interval
     ,minintervalAV$Steps
     ,type="l"
     ,col='red'
     ,main = "Average steps in 5 min interval"
     ,ylab = "Average steps"
     ,xlab = "Interval in min")
mSteps <- max(minintervalAV$Steps)
intmSteps<- minintervalAV[ minintervalAV$Steps == mSteps , 2]
```
`r mSteps` is the maximum number of steps  
`r intmSteps` is the interval at which the maximum occurs


## Imputing missing values

In this section the number of rows containing invalid data of NA values are calculated then the average value of the interval is substitued for the NA value to achieve a tidy data set.

```{r}
numMissingVal <- sum(is.na(csvdat))
fullData <- data.frame(steps = csvdat$steps ,date = csvdat$date, interval = csvdat$interval)
summary(fullData)
beforeProcess <- sum(is.na(fullData))
fullData$steps[which(is.na(fullData$steps))] <-
     minintervalAV$Steps 
    
afterProcess <- sum(is.na(fullData))
summary(fullData)
```

*  The total number of missing values in the data set is `r numMissingVal` rows  
*  Number of NA values before processing is `r beforeProcess`  
*  The number after processing is `r afterProcess`   

Results above and summary of data before processing and after processing indicates that only fields of NA values were altered.

###Mean and Median for Total number of steps for tidy data

In this part we recalculate the mean of the total number of steps taken per day for the tidy data set.   

```{r,echo=TRUE}
fstepsDay <- data.frame(steps = tapply(fullData$steps, fullData$date,sum))
hist(fstepsDay$steps
     , main ="Histogram of total number of steps per day for Tidy Data"
     ,col='red'
     ,breaks = 20
     ,xlab = "Number of steps per day")
fmu <- mean(fstepsDay$steps)
fmdn <- median(fstepsDay$steps)
```

The calculated mean is `r fmu` and the median is `r fmdn`

###Mean & Median Comparison before and after Imputing missing values

Comparing the mean for the two data sets before and after no change took place. Median value slightly changed and shifted towards the mean.
comparing the two histograms we find that data is more concentrated around the mean, and histogram is smoother towards the ends.


## Are there differences in activity patterns between weekdays and weekends?

In this part a day field and a day type field are added to the data frame then the dataframe is subsetted based on the day type to two distinct data frames one for weekdays and another for weekends. 


```{r}
fullData[,"day" ] <- sapply(c(fullData$date), weekdays)
fullData$day <-factor(fullData$day ,levels= 
    c("Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"))  
dayT <- function(n) {
    val <- as.character("weekday")
    if(n %in% c("Saturday","Sunday"))  {val <- as.character("weekend")  }
    val
    }

fullData[,"dayType"] <- sapply(fullData$day, dayT)
fullData$dayType <- factor(fullData$dayType, levels=c("weekday","weekend"))
weekdayData <- fullData[fullData$dayType == "weekday",]
weekdayData <- data.frame(Steps=tapply(weekdayData$steps,weekdayData$interval,mean,na.rm=T)
                            ,Interval=unique(weekdayData$interval))
weekendData <- fullData[fullData$dayType == "weekend",]
weekendData <- data.frame(Steps=tapply(weekendData$steps,weekendData$interval,mean,na.rm=T)
                            ,Interval=unique(weekendData$interval))

par(mfcol=c(1,2))
plot(
     weekdayData$Interval
     ,weekdayData$Steps
     ,type="l"
     ,col='red'
     ,main = "Weekdays"
     ,ylab = "Average steps in 5 min interval"
     ,xlab = "Interval in min")
abline(h=mean(weekdayData$Steps),col="red")
plot(
     weekendData$Interval
     ,weekendData$Steps
     ,type="l"
     ,col='blue'
     ,main = "Weekends"
     ,ylab = "Average steps in 5 min interval"
     ,xlab = "Interval in min")
abline(h=mean(weekendData$Steps),col="blue")



```
 
### conclusion 
The panel plots of the two time series shows the following:  
1  In weekdays number of steps are distributed over a wider range of values than those in weekend.  
2  In weekdays the early day intervals shows higher number of steps than later intervals while in weekdays such distinction is absent. 
